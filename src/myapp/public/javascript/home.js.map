{"version":3,"sources":["home.js"],"names":["$","home","init","insertArticles","results","str","i","length","articleId","bannerUrl","title","authorName","category","created","content","append","bindEvent","status","window","on","scrollTopHeightAfter","parseFloat","scrollTop","browserHeight","height","document","timeStr","last","find","text","timeArr","split","year","month","date","hour","minite","second","Date","getTime","ajax","type","url","async","contentType","error","err","alert","success","msg","JSON","parse","jQuery"],"mappings":"CAAA,SAAUA,GAEN,GAAIC,OAEAC,KAAM,aAINC,eAAgB,SAASC,SAErB,IAAK,GADDC,KAAM,GACDC,EAAI,EAAGA,EAAIF,QAAQG,OAAQD,IAChCD,KAAO,oDAAsDD,QAAQE,GAAGE,UAAY,yGAG5BJ,QAAQE,GAAGE,UAAY,eACxCJ,QAAQE,GAAGG,UAAY,gFAKFL,QAAQE,GAAGE,UAAY,mBAAqBJ,QAAQE,GAAGI,MAAQ,6GAIpEN,QAAQE,GAAGK,WAAa,6EAE3BP,QAAQE,GAAGM,SAAW,iEAEvCR,QAAQE,GAAGO,QAAU,qCAGxBT,QAAQE,GAAGQ,QAAU,0EAGOV,QAAQE,GAAGE,UAAY,wCAMvFR,GAAE,aAAae,OAAOV,MAG1BW,UAAW,WAEP,GAAIC,SAAS,CACbjB,GAAEkB,QAAQC,GAAG,SAAU,WACnB,GAAIC,sBAAuBC,WAAWrB,EAAEkB,QAAQI,aAC5CC,cAAeF,WAAWrB,EAAEkB,QAAQM,SAGxC,IAFqBH,WAAWrB,EAAEyB,UAAUD,UAEvBD,cAAgBH,sBAAwB,KAAOH,OAAQ,CAGxE,GAAIS,SAAU1B,EAAE,WAAW2B,OAAOC,KAAK,QAAQC,OAC3CC,QAAUJ,QAAQK,MAAM,KACxBC,KAAOF,QAAQ,GACfG,MAAQH,QAAQ,GAAK,EACrBI,KAAOJ,QAAQ,GAAGC,MAAM,KAAK,GAC7BI,KAAOL,QAAQ,GAAGC,MAAM,KAAK,GAAGA,MAAM,KAAK,GAC3CK,OAASN,QAAQ,GAAGC,MAAM,KAAK,GAAGA,MAAM,KAAK,GAC7CM,OAASP,QAAQ,GAAGC,MAAM,KAAK,GAAGA,MAAM,KAAK,GAC7ClB,QAAU,GAAKyB,MAAKN,KAAMC,MAAOC,KAAMC,KAAMC,OAAQC,QAASE,UAAY,GAE9EvC,GAAEwC,MACEC,KAAM,MACNC,IAAK,4BAA8B7B,QACnC8B,OAAO,EACPC,YAAa,iCACbC,MAAO,SAASC,KACZC,MAAMD,MAEVE,QAAS,SAASC,KACd,GAAY,SAARA,IAEA,MADAhC,SAAS,GACF,CAEXhB,MAAKE,eAAe+C,KAAKC,MAAMF,aAkEvDhD,MAAKC,OACLD,KAAKe,aACNoC","file":"home.js","sourcesContent":["(function($) {\r\n\r\n    var home = {\r\n\r\n        init: function() {\r\n\r\n        },\r\n\r\n        insertArticles: function(results) {\r\n            var str = '';\r\n            for (var i = 0; i < results.length; i++) {\r\n                str += '<article class=\"normal-article\" data-article-id=\"' + results[i].articleId + '\">' +\r\n                            '<div class=\"normal-article-wrap clearfix\">' +\r\n                                '<div class=\"normal-banner\">' +\r\n                                    '<a href=\"/getArticle?articleId=' + results[i].articleId + '\">' +\r\n                                        '<img src=\"' + results[i].bannerUrl + '\">' +\r\n                                    '</a>' +\r\n                                '</div>' +\r\n                                '<div class=\"normal-text-wrap\">' +\r\n                                    '<h1>' +\r\n                                        '<a href=\"/getArticle?articleId=' + results[i].articleId + '\" class=\"title\">' + results[i].title + '</a>' +\r\n                                    '</h1>' +\r\n                                    '<div class=\"article-meta\">' +\r\n                                        '<i class=\"fa fa-user\" aria-hidden=\"true\"></i>' +\r\n                                        '<span class=\"author-name\">' + results[i].authorName + '</span>' +\r\n                                        '<i class=\"fa fa-tag\" aria-hidden=\"true\"></i>' +\r\n                                        '<span class=\"category\">' + results[i].category + '</span>' +\r\n                                        '<i class=\"fa fa-calendar\" aria-hidden=\"true\"></i>' +\r\n                                        '<time>' + results[i].created + '</time>' +\r\n                                    '</div>' +\r\n                                    '<div class=\"text\">' +\r\n                                        '<p>' + results[i].content + '</p>' +\r\n                                    '</div>' +\r\n                                    '<div class=\"continue-reading\">' +\r\n                                        '<a href=\"/getArticle?articleId=' + results[i].articleId + '\">继续阅读</a>' +\r\n                                    '</div>' +\r\n                                '</div>' +\r\n                            '</div>' +\r\n                        '</article>';\r\n            }\r\n            $('.articles').append(str);\r\n        },\r\n\r\n        bindEvent: function() {\r\n            // 滚动加载\r\n            var status = true;\r\n            $(window).on('scroll', function() {\r\n                var scrollTopHeightAfter = parseFloat($(window).scrollTop());\r\n                var browserHeight= parseFloat($(window).height());\r\n                var documentHeight = parseFloat($(document).height());\r\n                \r\n                if (documentHeight - browserHeight - scrollTopHeightAfter <= 100 && status) {\r\n\r\n                    // 获取现在和1970年1月1日之间的毫秒数，再获取时间戳(格林威治时间1970年01月01日00时00分00秒起至现在的总秒数)\r\n                    var timeStr = $('article').last().find('time').text();\r\n                    var timeArr = timeStr.split('-');\r\n                    var year = timeArr[0];\r\n                    var month = timeArr[1] - 1;\r\n                    var date = timeArr[2].split(' ')[0];\r\n                    var hour = timeArr[2].split(' ')[1].split(':')[0];\r\n                    var minite = timeArr[2].split(' ')[1].split(':')[1];\r\n                    var second = timeArr[2].split(' ')[1].split(':')[2];\r\n                    var created = (new Date(year, month, date, hour, minite, second)).getTime() / 1000;\r\n\r\n                    $.ajax({\r\n                        type: 'get',\r\n                        url: '/getMoreArticles?created=' + created,\r\n                        async: false,\r\n                        contentType: 'application/json;charset=utf-8',\r\n                        error: function(err) {\r\n                            alert(err);\r\n                        },\r\n                        success: function(msg){\r\n                            if (msg === 'null') {\r\n                                status = false;\r\n                                return false;\r\n                            }\r\n                            home.insertArticles(JSON.parse(msg));\r\n                        }\r\n                    });\r\n\r\n                }\r\n\r\n            });\r\n        }\r\n\r\n    };\r\n\r\n    // function insertArticles(results) {\r\n    //     var str = '';\r\n    //     for (var i = 0; i < results.length; i++) {\r\n    //         str += '<article class=\"normal-article\" data-article-id=' + results[i].id + '>' +\r\n    //                     '<div class=\"normal-article-wrap clearfix\">' +\r\n    //                         '<div class=\"normal-banner\">' +\r\n    //                             '<a href=\"/getArticle?articleId=\"' + results[i].id + '>' +\r\n    //                                 '<img src=' + results[i].bannerUrl + '>' +\r\n    //                             '</a>' +\r\n    //                         '</div>' +\r\n    //                         '<div class=\"normal-text-wrap\">' +\r\n    //                             '<h1>' +\r\n    //                                 '<a href=\"/getArticle?articleId=\"' + results[i].id + 'class=\"title\">' + results[i].title + '</a>' +\r\n    //                             '</h1>' +\r\n    //                             '<div class=\"article-meta\">' +\r\n    //                                 '<i class=\"fa fa-user\" aria-hidden=\"true\"></i>' +\r\n    //                                 '<span class=\"author-name\">' + results[i].name + '</span>' +\r\n    //                                 '<i class=\"fa fa-tag\" aria-hidden=\"true\"></i>' +\r\n    //                                 '<span class=\"category\">' + results[i].category + '</span>' +\r\n    //                                 '<i class=\"fa fa-calendar\" aria-hidden=\"true\"></i>' +\r\n    //                                 '<time>' + results[i].created + '</time>' +\r\n    //                             '</div>' +\r\n    //                             '<div class=\"text\">' +\r\n    //                                 '<p>' + results[i].content + '</p>' +\r\n    //                             '</div>' +\r\n    //                             '<div class=\"continue-reading\">' +\r\n    //                                 '<a href=\"/getArticle?articleId=\"' + results[i].id + '>继续阅读</a>' +\r\n    //                             '</div>' +\r\n    //                         '</div>' +\r\n    //                     '</div>' +\r\n    //                 '</article>';\r\n    //     }\r\n    //     $('.articles').append(str);\r\n        \r\n    // }\r\n\r\n    // function bindEvent() {\r\n    //     $(window).scroll(function() {\r\n    //         var created = (new Date($('article').last().find('time').text())).getTime() / 1000;\r\n\r\n    //         console.log(created);\r\n            \r\n    //         $.ajax({\r\n    //             type: 'get',\r\n    //             url: '/getMoreArticles?created=' + created,\r\n    //             success: function(msg){\r\n    //                 console.log(msg);\r\n    //                 insertArticles(msg);\r\n\r\n    //             }\r\n    //         });\r\n\r\n    //     });\r\n    // }\r\n\r\n    home.init();\r\n    home.bindEvent();\r\n})(jQuery);"]}