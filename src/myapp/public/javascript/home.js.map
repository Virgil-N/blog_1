{"version":3,"sources":["home.js"],"names":["$","home","init","insertArticles","results","console","log","length","str","i","articleId","bannerUrl","title","authorName","category","created","content","append","bindEvent","window","on","scrollTopHeightAfter","parseFloat","scrollTop","browserHeight","height","document","Date","last","find","text","getTime","ajax","type","url","async","success","msg","JSON","parse","jQuery"],"mappings":"CAAA,SAAUA,GAEN,GAAIC,OAEAC,KAAM,aAINC,eAAgB,SAASC,SAErBC,QAAQC,IAAIF,QAASA,QAAQG,OAG7B,KAAK,GADDC,KAAM,GACDC,EAAI,EAAGA,EAAIL,QAAQG,OAAQE,IAChCD,KAAO,oDAAsDJ,QAAQK,GAAGC,UAAY,yGAG5BN,QAAQK,GAAGC,UAAY,eACxCN,QAAQK,GAAGE,UAAY,gFAKFP,QAAQK,GAAGC,UAAY,mBAAqBN,QAAQK,GAAGG,MAAQ,6GAIpER,QAAQK,GAAGI,WAAa,6EAE3BT,QAAQK,GAAGK,SAAW,iEAEvCV,QAAQK,GAAGM,QAAU,qCAGxBX,QAAQK,GAAGO,QAAU,0EAGOZ,QAAQK,GAAGC,UAAY,wCAMvFV,GAAE,aAAaiB,OAAOT,MAG1BU,UAAW,WAEPlB,EAAEmB,QAAQC,GAAG,SAAU,WACnB,GAAIC,sBAAuBC,WAAWtB,EAAEmB,QAAQI,aAC5CC,cAAeF,WAAWtB,EAAEmB,QAAQM,SAExC,IADqBH,WAAWtB,EAAE0B,UAAUD,UACvBD,cAAgBH,sBAAwB,IAAK,CAE9D,GAAIN,SAAU,GAAKY,MAAK3B,EAAE,WAAW4B,OAAOC,KAAK,QAAQC,QAASC,UAAY,GAE9E/B,GAAEgC,MACEC,KAAM,MACNC,IAAK,4BAA8BnB,QACnCoB,OAAO,EACPC,QAAS,SAASC,KACd,GAAY,SAARA,IACA,OAAO,CAEXpC,MAAKE,eAAemC,KAAKC,MAAMF,aAkEvDpC,MAAKC,OACLD,KAAKiB,aACNsB","file":"home.js","sourcesContent":["(function($) {\r\n\r\n    var home = {\r\n\r\n        init: function() {\r\n\r\n        },\r\n\r\n        insertArticles: function(results) {\r\n\r\n            console.log(results, results.length);\r\n\r\n            var str = '';\r\n            for (var i = 0; i < results.length; i++) {\r\n                str += '<article class=\"normal-article\" data-article-id=\"' + results[i].articleId + '\">' +\r\n                            '<div class=\"normal-article-wrap clearfix\">' +\r\n                                '<div class=\"normal-banner\">' +\r\n                                    '<a href=\"/getArticle?articleId=' + results[i].articleId + '\">' +\r\n                                        '<img src=\"' + results[i].bannerUrl + '\">' +\r\n                                    '</a>' +\r\n                                '</div>' +\r\n                                '<div class=\"normal-text-wrap\">' +\r\n                                    '<h1>' +\r\n                                        '<a href=\"/getArticle?articleId=' + results[i].articleId + '\" class=\"title\">' + results[i].title + '</a>' +\r\n                                    '</h1>' +\r\n                                    '<div class=\"article-meta\">' +\r\n                                        '<i class=\"fa fa-user\" aria-hidden=\"true\"></i>' +\r\n                                        '<span class=\"author-name\">' + results[i].authorName + '</span>' +\r\n                                        '<i class=\"fa fa-tag\" aria-hidden=\"true\"></i>' +\r\n                                        '<span class=\"category\">' + results[i].category + '</span>' +\r\n                                        '<i class=\"fa fa-calendar\" aria-hidden=\"true\"></i>' +\r\n                                        '<time>' + results[i].created + '</time>' +\r\n                                    '</div>' +\r\n                                    '<div class=\"text\">' +\r\n                                        '<p>' + results[i].content + '</p>' +\r\n                                    '</div>' +\r\n                                    '<div class=\"continue-reading\">' +\r\n                                        '<a href=\"/getArticle?articleId=' + results[i].articleId + '\">继续阅读</a>' +\r\n                                    '</div>' +\r\n                                '</div>' +\r\n                            '</div>' +\r\n                        '</article>';\r\n            }\r\n            $('.articles').append(str);\r\n        },\r\n\r\n        bindEvent: function() {\r\n            // 滚动加载\r\n            $(window).on('scroll', function() {\r\n                var scrollTopHeightAfter = parseFloat($(window).scrollTop());\r\n                var browserHeight= parseFloat($(window).height());\r\n                var documentHeight = parseFloat($(document).height());\r\n                if (documentHeight - browserHeight - scrollTopHeightAfter <= 300) {\r\n\r\n                    var created = (new Date($('article').last().find('time').text())).getTime() / 1000;\r\n\r\n                    $.ajax({\r\n                        type: 'get',\r\n                        url: '/getMoreArticles?created=' + created,\r\n                        async: false,\r\n                        success: function(msg){\r\n                            if (msg === 'null') {\r\n                                return false;\r\n                            }\r\n                            home.insertArticles(JSON.parse(msg));\r\n                        }\r\n                    });\r\n\r\n                }\r\n\r\n            });\r\n        }\r\n\r\n    };\r\n\r\n    // function insertArticles(results) {\r\n    //     var str = '';\r\n    //     for (var i = 0; i < results.length; i++) {\r\n    //         str += '<article class=\"normal-article\" data-article-id=' + results[i].id + '>' +\r\n    //                     '<div class=\"normal-article-wrap clearfix\">' +\r\n    //                         '<div class=\"normal-banner\">' +\r\n    //                             '<a href=\"/getArticle?articleId=\"' + results[i].id + '>' +\r\n    //                                 '<img src=' + results[i].bannerUrl + '>' +\r\n    //                             '</a>' +\r\n    //                         '</div>' +\r\n    //                         '<div class=\"normal-text-wrap\">' +\r\n    //                             '<h1>' +\r\n    //                                 '<a href=\"/getArticle?articleId=\"' + results[i].id + 'class=\"title\">' + results[i].title + '</a>' +\r\n    //                             '</h1>' +\r\n    //                             '<div class=\"article-meta\">' +\r\n    //                                 '<i class=\"fa fa-user\" aria-hidden=\"true\"></i>' +\r\n    //                                 '<span class=\"author-name\">' + results[i].name + '</span>' +\r\n    //                                 '<i class=\"fa fa-tag\" aria-hidden=\"true\"></i>' +\r\n    //                                 '<span class=\"category\">' + results[i].category + '</span>' +\r\n    //                                 '<i class=\"fa fa-calendar\" aria-hidden=\"true\"></i>' +\r\n    //                                 '<time>' + results[i].created + '</time>' +\r\n    //                             '</div>' +\r\n    //                             '<div class=\"text\">' +\r\n    //                                 '<p>' + results[i].content + '</p>' +\r\n    //                             '</div>' +\r\n    //                             '<div class=\"continue-reading\">' +\r\n    //                                 '<a href=\"/getArticle?articleId=\"' + results[i].id + '>继续阅读</a>' +\r\n    //                             '</div>' +\r\n    //                         '</div>' +\r\n    //                     '</div>' +\r\n    //                 '</article>';\r\n    //     }\r\n    //     $('.articles').append(str);\r\n        \r\n    // }\r\n\r\n    // function bindEvent() {\r\n    //     $(window).scroll(function() {\r\n    //         var created = (new Date($('article').last().find('time').text())).getTime() / 1000;\r\n\r\n    //         console.log(created);\r\n            \r\n    //         $.ajax({\r\n    //             type: 'get',\r\n    //             url: '/getMoreArticles?created=' + created,\r\n    //             success: function(msg){\r\n    //                 console.log(msg);\r\n    //                 insertArticles(msg);\r\n\r\n    //             }\r\n    //         });\r\n\r\n    //     });\r\n    // }\r\n\r\n    home.init();\r\n    home.bindEvent();\r\n})(jQuery);"]}