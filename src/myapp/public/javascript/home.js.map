{"version":3,"sources":["home.js"],"names":["$","home","init","insertArticles","results","str","i","length","articleId","bannerUrl","title","authorName","category","created","content","append","bindEvent","status","window","on","scrollTopHeightAfter","parseFloat","scrollTop","browserHeight","height","document","timeStr","last","find","text","timeArr","split","year","month","date","hour","minite","second","Date","getTime","ajax","type","url","async","contentType","error","err","alert","success","msg","JSON","parse","jQuery"],"mappings":"CAAA,SAAUA,GAEN,GAAIC,OAEAC,KAAM,aAINC,eAAgB,SAASC,SAErB,IAAK,GADDC,KAAM,GACDC,EAAI,EAAGA,EAAIF,QAAQG,OAAQD,IAChCD,KAAO,oDAAsDD,QAAQE,GAAGE,UAAY,yGAG5BJ,QAAQE,GAAGE,UAAY,eACxCJ,QAAQE,GAAGG,UAAY,gFAKFL,QAAQE,GAAGE,UAAY,mBAAqBJ,QAAQE,GAAGI,MAAQ,6GAIpEN,QAAQE,GAAGK,WAAa,6EAE3BP,QAAQE,GAAGM,SAAW,iEAEvCR,QAAQE,GAAGO,QAAU,qCAGxBT,QAAQE,GAAGQ,QAAU,0EAGOV,QAAQE,GAAGE,UAAY,wCAMvFR,GAAE,aAAae,OAAOV,MAG1BW,UAAW,WAEP,GAAIC,SAAS,CACbjB,GAAEkB,QAAQC,GAAG,SAAU,WACnB,GAAIC,sBAAuBC,WAAWrB,EAAEkB,QAAQI,aAC5CC,cAAeF,WAAWrB,EAAEkB,QAAQM,SAGxC,IAFqBH,WAAWrB,EAAEyB,UAAUD,UAEvBD,cAAgBH,sBAAwB,KAAOH,OAAQ,CAGxE,GAAIS,SAAU1B,EAAE,WAAW2B,OAAOC,KAAK,QAAQC,OAC3CC,QAAUJ,QAAQK,MAAM,KACxBC,KAAOF,QAAQ,GACfG,MAAQH,QAAQ,GAAK,EACrBI,KAAOJ,QAAQ,GAAGC,MAAM,KAAK,GAC7BI,KAAOL,QAAQ,GAAGC,MAAM,KAAK,GAAGA,MAAM,KAAK,GAC3CK,OAASN,QAAQ,GAAGC,MAAM,KAAK,GAAGA,MAAM,KAAK,GAC7CM,OAASP,QAAQ,GAAGC,MAAM,KAAK,GAAGA,MAAM,KAAK,GAC7ClB,QAAU,GAAKyB,MAAKN,KAAMC,MAAOC,KAAMC,KAAMC,OAAQC,QAASE,UAAY,GAE9EvC,GAAEwC,MACEC,KAAM,MACNC,IAAK,4BAA8B7B,QACnC8B,OAAO,EACPC,YAAa,iCACbC,MAAO,SAASC,KACZC,MAAMD,MAEVE,QAAS,SAASC,KACd,GAAY,SAARA,IAEA,MADAhC,SAAS,GACF,CAEXhB,MAAKE,eAAe+C,KAAKC,MAAMF,aAkEvDhD,MAAKC,OACLD,KAAKe,aACNoC","file":"home.js","sourcesContent":["(function($) {\n\n    var home = {\n\n        init: function() {\n\n        },\n\n        insertArticles: function(results) {\n            var str = '';\n            for (var i = 0; i < results.length; i++) {\n                str += '<article class=\"normal-article\" data-article-id=\"' + results[i].articleId + '\">' +\n                            '<div class=\"normal-article-wrap clearfix\">' +\n                                '<div class=\"normal-banner\">' +\n                                    '<a href=\"/getArticle?articleId=' + results[i].articleId + '\">' +\n                                        '<img src=\"' + results[i].bannerUrl + '\">' +\n                                    '</a>' +\n                                '</div>' +\n                                '<div class=\"normal-text-wrap\">' +\n                                    '<h1>' +\n                                        '<a href=\"/getArticle?articleId=' + results[i].articleId + '\" class=\"title\">' + results[i].title + '</a>' +\n                                    '</h1>' +\n                                    '<div class=\"article-meta\">' +\n                                        '<i class=\"fa fa-user\" aria-hidden=\"true\"></i>' +\n                                        '<span class=\"author-name\">' + results[i].authorName + '</span>' +\n                                        '<i class=\"fa fa-tag\" aria-hidden=\"true\"></i>' +\n                                        '<span class=\"category\">' + results[i].category + '</span>' +\n                                        '<i class=\"fa fa-calendar\" aria-hidden=\"true\"></i>' +\n                                        '<time>' + results[i].created + '</time>' +\n                                    '</div>' +\n                                    '<div class=\"text\">' +\n                                        '<p>' + results[i].content + '</p>' +\n                                    '</div>' +\n                                    '<div class=\"continue-reading\">' +\n                                        '<a href=\"/getArticle?articleId=' + results[i].articleId + '\">继续阅读</a>' +\n                                    '</div>' +\n                                '</div>' +\n                            '</div>' +\n                        '</article>';\n            }\n            $('.articles').append(str);\n        },\n\n        bindEvent: function() {\n            // 滚动加载\n            var status = true;\n            $(window).on('scroll', function() {\n                var scrollTopHeightAfter = parseFloat($(window).scrollTop());\n                var browserHeight= parseFloat($(window).height());\n                var documentHeight = parseFloat($(document).height());\n                \n                if (documentHeight - browserHeight - scrollTopHeightAfter <= 100 && status) {\n\n                    // 获取现在和1970年1月1日之间的毫秒数，再获取时间戳(格林威治时间1970年01月01日00时00分00秒起至现在的总秒数)\n                    var timeStr = $('article').last().find('time').text();\n                    var timeArr = timeStr.split('-');\n                    var year = timeArr[0];\n                    var month = timeArr[1] - 1;\n                    var date = timeArr[2].split(' ')[0];\n                    var hour = timeArr[2].split(' ')[1].split(':')[0];\n                    var minite = timeArr[2].split(' ')[1].split(':')[1];\n                    var second = timeArr[2].split(' ')[1].split(':')[2];\n                    var created = (new Date(year, month, date, hour, minite, second)).getTime() / 1000;\n\n                    $.ajax({\n                        type: 'get',\n                        url: '/getMoreArticles?created=' + created,\n                        async: false,\n                        contentType: 'application/json;charset=utf-8',\n                        error: function(err) {\n                            alert(err);\n                        },\n                        success: function(msg){\n                            if (msg === 'null') {\n                                status = false;\n                                return false;\n                            }\n                            home.insertArticles(JSON.parse(msg));\n                        }\n                    });\n\n                }\n\n            });\n        }\n\n    };\n\n    // function insertArticles(results) {\n    //     var str = '';\n    //     for (var i = 0; i < results.length; i++) {\n    //         str += '<article class=\"normal-article\" data-article-id=' + results[i].id + '>' +\n    //                     '<div class=\"normal-article-wrap clearfix\">' +\n    //                         '<div class=\"normal-banner\">' +\n    //                             '<a href=\"/getArticle?articleId=\"' + results[i].id + '>' +\n    //                                 '<img src=' + results[i].bannerUrl + '>' +\n    //                             '</a>' +\n    //                         '</div>' +\n    //                         '<div class=\"normal-text-wrap\">' +\n    //                             '<h1>' +\n    //                                 '<a href=\"/getArticle?articleId=\"' + results[i].id + 'class=\"title\">' + results[i].title + '</a>' +\n    //                             '</h1>' +\n    //                             '<div class=\"article-meta\">' +\n    //                                 '<i class=\"fa fa-user\" aria-hidden=\"true\"></i>' +\n    //                                 '<span class=\"author-name\">' + results[i].name + '</span>' +\n    //                                 '<i class=\"fa fa-tag\" aria-hidden=\"true\"></i>' +\n    //                                 '<span class=\"category\">' + results[i].category + '</span>' +\n    //                                 '<i class=\"fa fa-calendar\" aria-hidden=\"true\"></i>' +\n    //                                 '<time>' + results[i].created + '</time>' +\n    //                             '</div>' +\n    //                             '<div class=\"text\">' +\n    //                                 '<p>' + results[i].content + '</p>' +\n    //                             '</div>' +\n    //                             '<div class=\"continue-reading\">' +\n    //                                 '<a href=\"/getArticle?articleId=\"' + results[i].id + '>继续阅读</a>' +\n    //                             '</div>' +\n    //                         '</div>' +\n    //                     '</div>' +\n    //                 '</article>';\n    //     }\n    //     $('.articles').append(str);\n        \n    // }\n\n    // function bindEvent() {\n    //     $(window).scroll(function() {\n    //         var created = (new Date($('article').last().find('time').text())).getTime() / 1000;\n\n    //         console.log(created);\n            \n    //         $.ajax({\n    //             type: 'get',\n    //             url: '/getMoreArticles?created=' + created,\n    //             success: function(msg){\n    //                 console.log(msg);\n    //                 insertArticles(msg);\n\n    //             }\n    //         });\n\n    //     });\n    // }\n\n    home.init();\n    home.bindEvent();\n})(jQuery);"]}